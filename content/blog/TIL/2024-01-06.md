---
title: "[TS] react-i18next ë‹¤êµ­ì–´í…ìŠ¤íŠ¸ íƒ€ì… ì§€ì •"
date: 2024-01-06 13:01:00
category: til
thumbnail: 'ts'
description: 'ìœ ì €ì˜ íœ´ëŒ€í° ì‹œìŠ¤í…œ ì–¸ì–´ë¥¼ ì•± ìµœì´ˆ ì–¸ì–´ë¡œ ì„¤ì •í•˜ë ¤ê³  í–ˆì„ ë•Œ ë°œìƒí•œ íƒ€ì… ì—ëŸ¬ í•´ê²°ê¸°.'
draft: false
---

React Nativeì—ì„œ `react-i18next`ë¥¼ ì‚¬ìš©í•´ì„œ <u>1ï¸âƒ£í•œêµ­ì–´</u>, <u>2ï¸âƒ£ì˜ì–´</u>, <u>3ï¸âƒ£ì¸ë„ë„¤ì‹œì•„ì–´</u> ì´ 3ê°œì˜ ì–¸ì–´ë¥¼ ì§€ì›í•  í•„ìš”ê°€ ìˆì—ˆë‹¤.

ì‚¬ìš©í•œ ë‹¤êµ­ì–´ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ê°ê°ì˜ ë²„ì ¼ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.


```
- i18next: v22.5.11
- react-i18next: v12.3.1
- react-native-localize: v2.2.6 (ê¸°ê¸° ì‹œìŠ¤í…œ ì–¸ì–´ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ì‚¬ìš©)
```

íŒŒì¼ êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```bash
./
â”‚
â”‚... 
â”‚
â”œâ”€â”€ i18n.ts
â”œâ”€â”€ i18next.d.ts
â””â”€â”€ locales
 Â Â  â”œâ”€â”€ en
 Â Â  â”‚Â Â  â”œâ”€â”€ index.ts
 Â Â  â”‚Â Â  â””â”€â”€ translation.json
 Â Â  â”œâ”€â”€ id
 Â Â  â”‚Â Â  â”œâ”€â”€ index.ts
 Â Â  â”‚Â Â  â””â”€â”€ translation.json
 Â Â  â””â”€â”€ ko
 Â Â      â”œâ”€â”€ index.ts
 Â Â      â””â”€â”€ translation.json
```


### 1ï¸âƒ£ i18n.ts

```tsx
import i18next from 'i18next';
import { initReactI18next } from 'react-i18next';
import { getLocales } from 'react-native-localize';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { ASYNC_STORAGE_KEYS } from 'constants/common';
import en from './locales/en';
import id from './locales/id';
import ko from './locales/ko';
import type { LanguageDetectorAsyncModule } from 'i18next';
import type { LanguageTypes } from 'types/common';

export const locales = { en, ko, id };

// ë””ë°”ì´ìŠ¤ ì„¤ì •ì—ì„œ ê°€ì¥ ìœ„ë¡œ ì„ íƒëœ ì–¸ì–´ê°€ í˜„ì¬ ë””ë°”ì´ìŠ¤ì— ì ìš©ëœ ì–¸ì–´. ë”°ë¼ì„œ ë°°ì—´ì— 0ë²ˆì§¸ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´.
// ì–¸ì–´ ì½”ë“œë¥¼ ì˜ë¯¸í•¨, ex) 'en', 'ko', 'id', ...
export const deviceSystemLanguage = getLocales()[0].languageCode;

const languageDetector: LanguageDetectorAsyncModule = {
  type: 'languageDetector',
  async: true,
  detect: callback => {
    AsyncStorage.getItem(ASYNC_STORAGE_KEYS.language).then(lang => {
      if (lang) {
        // AsyncStorageì— ì €ì¥ëœ ì–¸ì–´ê°€ ìˆìœ¼ë©´ í•´ë‹¹ ì–¸ì–´ë¥¼ ì‚¬ìš©
        callback(lang);
      }
      
	  callback(deviceSystemLanguage);
    });
    return;
  },
  cacheUserLanguage: (language: LanguageTypes) => {
    AsyncStorage.setItem(ASYNC_STORAGE_KEYS.language, language);
  },
};

const i18n = i18next
  .use(languageDetector)
  .use(initReactI18next)
  .init({
    fallbackLng: 'en',
    resources: locales,
    returnObjects: true,
    react: {
      useSuspense: false,
    },
  });

export default i18n;
```

<u>ì•±ì„ ìµœì´ˆë¡œ ì‹¤í–‰í•  ë•Œ ê¸°ê¸°ì˜ ì‹œìŠ¤í…œ ì–¸ì–´ë¥¼ ì•± ê¸°ë³¸ì–¸ì–´ë¡œ ì‚¬ìš©</u>í•˜ê¸° ìœ„í•´, ìœ„ì™€ ê°™ì´ `languageDetector`ë¥¼ ì •ì˜í•œë‹¤.

ê¸°ë³¸ì ì¸ êµ¬ì¡°ëŠ” [`i18next` ê³µì‹ë¬¸ì„œ](https://www.i18next.com/misc/creating-own-plugins#languagedetector)ë¥¼ ê·¸ëŒ€ë¡œ ì°¸ê³ í•˜ì˜€ë‹¤.



### 2ï¸âƒ£ i18next.d.ts

```ts
import type { locales, deviceSystemLanguage } from './i18n';

declare module 'i18next' {
  interface CustomTypeOptions {
    defaultNS: typeof deviceSystemLanguage;
    resources: (typeof locales)[deviceSystemLanguage];
  }
}
```

ìœ„ ì½”ë“œ ë˜í•œ [`i18next` ê³µì‹ë¬¸ì„œ](https://www.i18next.com/overview/typescript)ì— ì‘ì„±ëœ ì˜ˆì œ ì½”ë“œë¥¼ ì°¸ê³ í•˜ì—¬ ì‘ì„±í•˜ì˜€ë‹¤. 

### 3ï¸âƒ£.1ï¸âƒ£ locales/{{ns}}/translation.json

```json
{
  "TEXT_1": "Text 1",
  "TEXT_2": "Text 2",
  "TEXT_3": "Text 3"
}
```

`json` íŒŒì¼ì— ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ë¥¼ ì „ë¶€ ì‘ì„±í•œë‹¤. 

ë‚˜ëŠ” ì „ë¶€ 1 depthë¡œ ì‘ì„±í•˜ì˜€ì§€ë§Œ, ì¤‘ì²© ê°ì²´ í˜•íƒœë¡œ ì‘ì„±í•˜ì—¬ë„ ë¬´ë°©í•˜ë‹¤. 

### 3ï¸âƒ£.2ï¸âƒ£ locales/{{ns}}/index.ts

```ts
import translation from 'locales/{{ns}}/translation.json';

export default {
  translation,
};

```

ìœ„ì™€ ê°™ì´ êµ¬ì„±ì„ í•˜ë©´, ì•„ë˜ì™€ ê°™ì´ ë‹¤êµ­ì–´ í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```jsx
import { useTranslation } from 'react-i18next';
...

const SomeScreen = () => {
  const { t } = useTranslation('translation');
  
  return (
    <View>
      <Text>{t('TEXT_1')}</Text> 
      <Text>{t('TEXT_2')}</Text>
      <Text>{t('TEXT_3')}</Text>
    </View>
  );
};
```
## ğŸš¨íƒ€ì… ì¶”ë¡  ì´ìŠˆ  


`i18next.d.ts`ê°€ ì œëŒ€ë¡œ ì‘ì„±ë˜ì§€ ëª»í•œ íƒ“ì¸ì§€, `useTranslation` í›…ì„ í˜¸ì¶œí•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.

```tsx
const { t } = useTranslation('translation');
// Type instantiation is excessively deep and possibly infinite.
```

[`react-i18next` ê³µì‹ Issue ë€ì—ì„œ ë™ì¼í•œ ì´ìŠˆë¥¼ ì–¸ê¸‰í•œ ê¸€](https://github.com/i18next/react-i18next/issues/1417)ì´ ìˆëŠ”ë°, ê±°ê¸°ì„œëŠ” Typescriptì˜ `recursive type instantiations` ì˜ ìƒí•œì„ ì´ 50 ~ 100ì´ê¸° ë•Œë¬¸ì—, í•´ë‹¹ ìƒí•œì„ ì´ˆê³¼í•˜ëŠ” ê²½ìš° ë°œìƒí•  ìˆ˜ ìˆëŠ” ì—ëŸ¬ë¼ê³  í•œë‹¤.

![](https://i.imgur.com/UL7npQF.png)



í•´ë‹¹ ê¸€ì„ í† ëŒ€ë¡œ <u>`translation.json`ì— ì •ì˜ëœ í”„ë¡œí¼í‹° ìˆ˜ê°€ ë„ˆë¬´ ë§ì€ ê²ƒì´ ë¬¸ì œ</u>ë¼ê³  ìƒê°ì„ í•˜ì˜€ë‹¤.
 
ì—ëŸ¬ ë°œìƒ ë‹¹ì‹œ ê¸°ì¤€ `translation.json`ì—ëŠ” 600ê°œ ì •ë„ì˜ í”„ë¡œí¼í‹°ê°€ ì •ì˜ë˜ì–´ ìˆì—ˆë‹¤.

<img src="https://i.imgur.com/EjS2E7J.png" />

í•˜ì§€ë§Œ, ì„ì‹œë¡œ í”„ë¡œí¼í‹°ë¥¼ 1ê°œë§Œ ì‘ì„±í•´ì„œ í…ŒìŠ¤íŠ¸ í•´ ë³´ì•˜ëŠ”ë°ë„ ì´ìŠˆëŠ” í•´ê²°ë˜ì§€ ëª»í–ˆë‹¤...

---
## âœ… ë°©ë²• 1 (ì°¨ì„ )

```ts
import type { locales, deviceSystemLanguage } from './i18n';

declare module 'i18next' {
  interface CustomTypeOptions {
    defaultNS: typeof deviceSystemLanguage;
    resources: (typeof locales)['en'];
  }
}
```

ìœ„ì™€ ê°™ì´ ì§ì ‘ `'en'` ë‹¨ì¼ íƒ€ì…ë§Œ ì „ë‹¬í•˜ë©´ ì¼ë‹¨ íƒ€ì… ì—ëŸ¬ëŠ” í•´ê²°ëœë‹¤.

í•˜ì§€ë§Œ, ì´ ê²½ìš°Â `locales/en/translation.json`ì— ì •ì˜ëœ í”„ë¡œí¼í‹° ëª…ì´Â `ko`,Â `id`ì˜ í”„ë¡œí¼í‹°ëª…ê³¼ ë‹¬ë¼ë„ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ì§€ ì•Šê¸° ë•Œë¬¸ì—, ì¢‹ì€ ë°©ë²•ì´ ì•„ë‹ˆë‹¤.

---
## âœ… ë°©ë²• 2 (ìµœì„ )


```ts
import type { locales, deviceSystemLanguage } from './i18n';

type DeviceSystemLangauges = 'en' | 'ko' | 'id'; 

declare module 'i18next' {
  interface CustomTypeOptions {
    defaultNS: typeof deviceSystemLanguage;
    resources: (typeof locales)[DeviceSystemLangauges];
  }
}
```


`i18n.ts`ì—ì„œ `string`ìœ¼ë¡œ ì¶”ë¡ ë˜ëŠ” `deviceSystemLangauge`ì„ ê°€ì ¸ì™€ì„œ `resources` íƒ€ì…ì„ ì •ì˜í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì§ì ‘ ìœ ë‹ˆì–¸ íƒ€ì… `DeviceSystemLangauges`ë¥¼ ì •ì˜í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.

ì´ë ‡ê²Œ í•  ê²½ìš° ì¥ì ì€, `locales/{{ns}}/translation.json` 3ê°œì˜ íŒŒì¼ ê°ê°ì—ì„œ <u>ì–´ë–¤ í•˜ë‚˜ì˜ í”„ë¡œí¼í‹°ë¼ë„ ë‹¤ë¥¸ í”„ë¡œí¼í‹°ì™€ ì‹±í¬ê°€ ë§ì§€ ì•ŠëŠ”ë‹¤ë©´, íƒ€ì… ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¨ë‹¤</u>ëŠ” ì ì´ë‹¤.

> ### ğŸ¤¨ ë§Œì•½ ê¸°ê¸°ì–¸ì–´ê°€ `en`, `ko`, `id` ì™¸ì˜ ê°’ì¸ ê²½ìš°ì—ëŠ”?
> 
> <img src="https://i.imgur.com/I5kGz9J.png">
>
> ì‚¬ì§„ê³¼ ê°™ì´, `fallbackLng`ë¥¼ ì •ì˜í•œë‹¤ë©´ í•´ë‹¹ ê²½ìš°ë¥¼ í•¸ë“¤ë§í•  ìˆ˜ ìˆë‹¤.

