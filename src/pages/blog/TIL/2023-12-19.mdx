---
title: '[React] RHFì— Zod ë¼ì–¹ê¸°'
date: 2023-12-19 18:12:57
category: React
thumbnail: 'rhf'
description: 'ìœ íš¨ì„± ê²€ì‚¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ Zodë¥¼ React Hook Formì— í†µí•©í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì.'
draft: false
---

import Layout from '/src/templates/blog-post';
export default Layout;

import videoSrc1 from '/content/assets/videos/2023-12-19_1.mp4';
import videoSrc2 from '/content/assets/videos/2023-12-19_2.mp4';

![](https://i.imgur.com/RCWCoux.png)

[zod](https://github.com/colinhacks/zod)ëŠ” <u>Typescriptë¡œ ì‘ì„±ëœ ìœ íš¨ì„± ê²€ì‚¬ ë¼ì´ë¸ŒëŸ¬ë¦¬</u>ì´ë‹¤.

`zod` ì´ì „ì—ëŠ” [yup](https://github.com/jquense/yup)ì´ ë„ë¦¬ ì‚¬ìš©ë˜ì—ˆìœ¼ë‚˜, Typescript í†µí•©ì„ ì¥ì ìœ¼ë¡œ ë‚´ì„¸ìš´ `zod`ì˜ ë“±ì¥ìœ¼ë¡œ ì¸í•´ ì´ì „ë§Œí¼ì˜ ìœ„ì„¸ëŠ” ì•„ë‹ˆê²Œ ëœ ìƒíƒœì´ë‹¤.

í•˜ì§€ë§Œ `yup` ë˜í•œ ì—¬ì „íˆ ë§ì€ ì‚¬ëŒë“¤ì´ ì‚¬ìš©í•˜ê³  ìˆê³ , ìµœê·¼ì—ëŠ” `yup` ë˜í•œ Typescriptë¥¼ ì§€ì›í•˜ê³  ìˆìœ¼ë¯€ë¡œ, <u>ë‘˜ ì¤‘ ì–´ë–¤ ê²ƒì„ ì‚¬ìš©í• ì§€ëŠ” ìˆœì „íˆ ì„ íƒì˜ ë¬¸ì œ</u>ì´ë‹¤.


### ğŸ§ zod ì‚¬ìš©ë°©ë²•

ì•„ë˜ì™€ ê°™ì´ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•œë‹¤.

```bash
yarn add zod react-hook-form @hookform/resolvers
```

ì„¤ì¹˜í–ˆìœ¼ë©´ ì•„ë˜ì™€ ê°™ì´ ëª¨ë“ˆì„ importí•  ìˆ˜ ìˆë‹¤.

```tsx
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import * as z from 'zod';
```


### ğŸ“ zod ìŠ¤í‚¤ë§ˆ ì‘ì„±


```markdown
ìœ íš¨ì„± ê²€ì‚¬ ë°©ì‹ : ì œì¶œ(submit)í•  ë•Œë§Œ ê²€ì‚¬

1. ì´ë©”ì¼
  - í•„ìˆ˜ê°’
  - ìœ íš¨í•œ ì´ë©”ì¼ í˜•ì‹ì¸ì§€ í™•ì¸

2. ë¹„ë°€ë²ˆí˜¸
  - í•„ìˆ˜ê°’
  - 6ì ì´ìƒ, 30ì ì´í•˜
  - ë¹„ë°€ë²ˆí˜¸ í™•ì¸ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
```

ìœ„ì™€ ê°™ì´ í¼ì˜ ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§ì„ ì‘ì„±í•´ë³´ì.



```ts
const schema = z
  .object({
    email: z
      .string({
        required_error: 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.',
      })
      .email({ message: 'ì´ë©”ì¼ í˜•ì‹ì— ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.' }),
    password: z
      .string({
        required_error: 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
      })
      .min(6, { message: 'ìµœì†Œ 6ì ì´ìƒìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.' })
      .max(30, { message: 'ìµœëŒ€ 30ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.' }),
    passwordCheck: z.string({
      required_error: 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
    }),
  })
  .superRefine(({ password, passwordCheck }, context) => {
    if (password !== passwordCheck) {
      context.addIssue({
        code: z.ZodIssueCode.custom,
        message: 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.',
        path: ['passwordCheck'],
      });
    }
  });
```
ê¸°ë³¸ì ìœ¼ë¡œ zodë¡œ ì‘ì„±í•œ ìŠ¤í‚¤ë§ˆì˜ ëª¨ë“  í•„ë“œëŠ” `NonNullable`ì´ë‹¤.
  * `null` ê°’ì„ í—ˆìš©í•˜ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ” `.nullable()` ë©”ì„œë“œë¥¼ ì‚¬ìš©.
  * `null`, `undefined` ê°’ì„ í—ˆìš©í•˜ê³  ì‹¶ì€ ê²½ìš°ë„¤ëŠ” `.nullish()` ë©”ì„œë“œë¥¼ ì‚¬ìš©.


í•„ìˆ˜ í•­ëª©ì„ ì‘ì„±í•˜ì§€ ì•Šì•˜ì„ ë•Œ ì»¤ìŠ¤í…€ ì—ëŸ¬ë©”ì„¸ì§€ë¥¼ ë„ìš°ê³  ì‹¶ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•œë‹¤.

```
.[ì›ì‹œí˜•]({ required_error: "ì—ëŸ¬ë©”ì„¸ì§€" })
```

ìœ„ ì˜ˆì œì—ì„œëŠ” `.string({ required_error: 'ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'})`ë¡œ ì‘ì„±í–ˆë‹¤.

ì°¸ê³ ë¡œ, ë¹„ìŠ·í•œ ê¸°ëŠ¥ì„ ì œê³µí•  ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ” `nonempty` ë©”ì„œë“œ ë˜í•œ ì¡´ì¬í•˜ëŠ”ë°, ì´ëŠ” ì˜ˆìƒê³¼ëŠ” ë‹¬ë¦¬ <u>ë°°ì—´ì˜ ê¸¸ì´ê°€ 0ì´ ì•„ë‹ˆë„ë¡ í•˜ëŠ” ê²€ì‚¬ ë©”ì„œë“œ</u>ì´ë¯€ë¡œ ì£¼ì˜í•œë‹¤..

![nonempty](https://i.imgur.com/2y4qzHD.png)


**ë¹„ë°€ë²ˆí˜¸**, **ë¹„ë°€ë²ˆí˜¸ í™•ì¸**ê³¼ ê°™ì´, <u>ë™ì‹œì— 2ê°œì˜ í•„ë“œë¥¼ ì„œë¡œ ëŒ€ì¡°í•´ê°€ë©´ì„œ ìœ íš¨ì„±ì„ ê²€ì‚¬</u>í•˜ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ”, [ì—¬ê¸° stack overflow ê¸€](https://stackoverflow.com/questions/73695535/how-to-check-confirm-password-with-zod)ì„ ì°¸ì¡°í•˜ë©´ <u>ì»¤ìŠ¤í…€ ìœ íš¨ì„± ê²€ì‚¬</u>ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆëŠ” `superRefine` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.



### ğŸ”— RHFì— zod ì—°ê²°í•˜ê¸°


```ts
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';

...

const { control, handleSubmit } = useForm({
  resolver: zodResolver(schema),
  mode: 'onSubmit', // ì œì¶œí•  ë•Œë§Œ ìœ íš¨ì„± ê²€ì‚¬
  reValidateMode: 'onSubmit', // ì œì¶œí•  ë•Œë§Œ ìœ íš¨ì„± ê²€ì‚¬
});
```


zod ìŠ¤í‚¤ë§ˆë¥¼ ì „ë¶€ ì‘ì„±í–ˆë‹¤ë©´, ìœ„ì™€ ê°™ì´ `useForm`, `zodResolver`ë¥¼ importí•´ì˜¨ ë‹¤ìŒ `useForm` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì•¼ í•œë‹¤.

ì‹¤ì‹œê°„ ìœ íš¨ì„± ê²€ì‚¬ê°€ ì•„ë‹ˆë¼ ì œì¶œ ë²„íŠ¼ì„ í´ë¦­í•  ë•Œ ê²€ì‚¬í•˜ë¯€ë¡œ `mode`, `reValidateMode` í”„ë¡œí¼í‹°ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜íŒë‹¤.
  * `mode: 'onSubmit'`
  * `reValidateMode: 'onSubmit'`

ê·¸ë ‡ë‹¤ë©´ ì‹¤ì œë¡œ ë™ì‘í•˜ëŠ” ë°©ì‹ì€ ì•„ë˜ ë™ì˜ìƒê³¼ ê°™ë‹¤.

<Video videoSrcURL={videoSrc1} />

<br />
<br />


ë§Œì•½, `mode: 'onSubmit'`ë§Œ ì •ì˜í•˜ê³ , `reValidateMode`ë¥¼ ë”°ë¡œ ì •ì˜í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, ìµœì´ˆ 1íšŒ submitë˜ê¸° ì „ê¹Œì§€ëŠ” `onSubmit`ìœ¼ë¡œ ë™ì‘í•˜ë‹¤ê°€, ì´í›„ submitì´ ëœ ê²½ìš°ì—ëŠ” `onChange`ë¡œ ë™ì‘í•˜ê²Œ ëœë‹¤.

<br />

<Video videoSrcURL={videoSrc2} />

<br />

ë”°ë¼ì„œ, ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ê¸° ìœ„í•´ì„œëŠ” ë‘˜ë‹¤ `onSubmit` ê°’ì„ ì£¼ì–´ì•¼ í•œë‹¤.


---

### ğŸ˜± RHFê³¼ zodë¥¼ ê°™ì´ ì‚¬ìš©í•  ë•Œì˜ ì£¼ì˜ì 

```jsx
const { control, handleSubmit } = useForm({
  resolver: zodResolver(schema),
  mode: 'onSubmit',
  reValidateMode: 'onSubmit',
});
```

ìœ„ì™€ ê°™ì´ `useForm`ì„ í˜¸ì¶œí•  ë•Œ ì»¤ìŠ¤í…€ `resolver`ë¥¼ ë“±ë¡í•˜ê²Œ ë˜ëŠ” ê²½ìš°, `<Controller>`ì— ì‘ì„±í•œ `rules` ì†ì„±ì€ ë¬´ì‹œëœë‹¤!!



#### âŒ useFormì— resolver í•„ë“œë¥¼ ì •ì˜í•˜ì§€ ì•ŠëŠ” ê²½ìš°

```jsx
const { control, handleSubmit } = useForm({
  // resolver: zodResolver(schema),
  mode: 'onSubmit',
  reValidateMode: 'onSubmit',
});
```

ìœ„ì™€ ê°™ì´ `useForm`ì„ í˜¸ì¶œí•  ë•Œ ë”°ë¡œ `resolver`ë¥¼ ì •ì˜í•˜ì§€ ì•Šê³ ,

![](https://i.imgur.com/tLMRMtg.png)

`Controller`ì˜ rules propì—ì„œ `"ì…ë ¥í•´ì£¼ì„¸ìš”"`ë¼ê³  ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ì‘ì„±í•œë‹¤.

![](https://i.imgur.com/Le0YaTK.png)

`zod`ë¡œ ì •ì˜í•œ ìŠ¤í‚¤ë§ˆì—ì„œëŠ” `"ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."`ë¼ê³  ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ì‘ì„±í–ˆë‹¤ê³  í•´ ë³´ì.

<Image imageSrcURL="https://i.imgur.com/uexLGqI.jpg" width="40%" />

ê·¸ë ‡ë‹¤ë©´ ìœ„ì²˜ëŸ¼ `rules` propì´ ì •ìƒì ìœ¼ë¡œ ì ìš©ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

#### â­•ï¸ useFormì— resolver í•„ë“œë¥¼ ì •ì˜í•œ ê²½ìš°

![](https://i.imgur.com/cagpojH.png)

ì´ë²ˆì—ëŠ” `required_error`ë¥¼ ë”°ë¡œ ì •ì˜í•˜ì§€ ì•Šì€ì±„ë¡œ, resolver í•„ë“œë¥¼ ì •ì˜í•´ë³´ì.

<Image imageSrcURL="https://i.imgur.com/42YFtUd.jpg" width="40%" />

ê·¸ë ‡ë‹¤ë©´ `rules`ì˜ `"ì…ë ¥í•´ì£¼ì„¸ìš”"` ì—ëŸ¬ë©”ì„¸ì§€ëŠ” ë¬´ì‹œë˜ê³ , `react-hook-form`ì˜ ë””í´íŠ¸ ì—ëŸ¬ë©”ì„¸ì§€ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤...

> ì¦‰, `zod`ë¥¼ `resolver`ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë¼ë©´, `Controller`ì— `rules`ë¥¼ ì •ì˜í•  í•„ìš”ë„ ì—†ì„ ë¿ë”ëŸ¬, ì ìš©í•´ë´¤ì ë¬´ì‹œëœë‹¤.



